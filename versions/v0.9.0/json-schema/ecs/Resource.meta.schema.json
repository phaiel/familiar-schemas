{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://familiar.dev/schemas/ecs/Resource.meta.schema.json",
  "title": "ECS Resource Meta-Schema",
  "description": "Schema for defining ECS Resources - external dependencies like databases and APIs. Resources can be internal (owned) or virtual (external APIs acting as proxy contracts)",
  "type": "object",
  "required": ["title", "x-familiar-kind", "x-familiar-resource-type"],
  "properties": {
    "$schema": {
      "type": "string",
      "const": "http://json-schema.org/draft-07/schema#"
    },
    "title": {
      "type": "string",
      "description": "Human-readable name for the resource (e.g., PostgresMain)"
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of the resource's purpose"
    },
    "x-familiar-kind": {
      "type": "string",
      "const": "resource",
      "description": "Must be 'resource' for resource schemas"
    },
    "x-familiar-resource-type": {
      "type": "string",
      "enum": ["database", "cache", "llm-api", "http-api", "message-queue", "storage"],
      "description": "The type of external resource"
    },
    "x-familiar-virtual": {
      "type": "boolean",
      "default": false,
      "description": "True if this is a proxy schema for an external API you don't own (e.g., OpenAI)"
    },
    "x-familiar-config": {
      "type": "object",
      "properties": {
        "$ref": {
          "type": "string",
          "description": "Reference to the configuration schema for this resource"
        }
      },
      "description": "Reference to configuration schema (e.g., DbPoolConfig)"
    },
    "x-familiar-tables": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "For databases: list of tables/collections this resource manages"
    },
    "x-familiar-endpoint": {
      "type": "string",
      "format": "uri",
      "description": "For APIs: the base endpoint URL"
    },
    "x-familiar-rate-limit": {
      "type": "integer",
      "minimum": 0,
      "description": "Requests per minute limit"
    },
    "x-familiar-models": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "For LLM APIs: available model identifiers"
    },
    "x-familiar-connection-pool": {
      "type": "object",
      "properties": {
        "min": {
          "type": "integer",
          "minimum": 0,
          "default": 1
        },
        "max": {
          "type": "integer",
          "minimum": 1,
          "default": 10
        }
      },
      "description": "Connection pool configuration"
    },
    "x-familiar-health-check": {
      "type": "object",
      "properties": {
        "endpoint": {
          "type": "string",
          "description": "Health check endpoint path"
        },
        "interval": {
          "type": "string",
          "pattern": "^\\d+(s|m)$",
          "description": "Health check interval"
        }
      },
      "description": "Health check configuration"
    }
  },
  "additionalProperties": true
}





