{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "DbStoreError",
  "description": "Errors that can occur during database operations",
  "oneOf": [
    {
      "description": "Connection failed",
      "type": "object",
      "required": [
        "details",
        "type"
      ],
      "properties": {
        "details": {
          "type": "object",
          "required": [
            "message"
          ],
          "properties": {
            "message": {
              "type": "string"
            }
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "Connection"
          ]
        }
      }
    },
    {
      "description": "Query execution failed",
      "type": "object",
      "required": [
        "details",
        "type"
      ],
      "properties": {
        "details": {
          "type": "object",
          "required": [
            "message"
          ],
          "properties": {
            "message": {
              "type": "string"
            },
            "query": {
              "type": [
                "string",
                "null"
              ]
            }
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "Query"
          ]
        }
      }
    },
    {
      "description": "Entity not found",
      "type": "object",
      "required": [
        "details",
        "type"
      ],
      "properties": {
        "details": {
          "type": "object",
          "required": [
            "entity_type",
            "id"
          ],
          "properties": {
            "entity_type": {
              "type": "string"
            },
            "id": {
              "type": "string"
            }
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "NotFound"
          ]
        }
      }
    },
    {
      "description": "Constraint violation (unique, foreign key, etc.)",
      "type": "object",
      "required": [
        "details",
        "type"
      ],
      "properties": {
        "details": {
          "type": "object",
          "required": [
            "message"
          ],
          "properties": {
            "message": {
              "type": "string"
            }
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "Constraint"
          ]
        }
      }
    },
    {
      "description": "Serialization/deserialization error",
      "type": "object",
      "required": [
        "details",
        "type"
      ],
      "properties": {
        "details": {
          "type": "object",
          "required": [
            "message"
          ],
          "properties": {
            "message": {
              "type": "string"
            }
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "Serialization"
          ]
        }
      }
    },
    {
      "description": "Transaction failed",
      "type": "object",
      "required": [
        "details",
        "type"
      ],
      "properties": {
        "details": {
          "type": "object",
          "required": [
            "message"
          ],
          "properties": {
            "message": {
              "type": "string"
            }
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "Transaction"
          ]
        }
      }
    },
    {
      "description": "Migration error",
      "type": "object",
      "required": [
        "details",
        "type"
      ],
      "properties": {
        "details": {
          "type": "object",
          "required": [
            "message"
          ],
          "properties": {
            "message": {
              "type": "string"
            }
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "Migration"
          ]
        }
      }
    },
    {
      "description": "Operation failed (e.g. S3/MinIO)",
      "type": "object",
      "required": [
        "details",
        "type"
      ],
      "properties": {
        "details": {
          "type": "object",
          "required": [
            "message"
          ],
          "properties": {
            "message": {
              "type": "string"
            }
          }
        },
        "type": {
          "type": "string",
          "enum": [
            "Operation"
          ]
        }
      }
    }
  ]
}