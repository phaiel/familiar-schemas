{
  "$id": "https://familiar.dev/schem../infrastructure/systems/FatesGate.system.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Entry point to the Fates pipeline. Performs initial classification and routing of incoming messages.",
  "dispatch": [
    {
      "mapping": {
        "input": "gate_input"
      },
      "technique": {
        "$ref": "../../techniques/ingest_weave.technique.json"
      },
      "trigger": "kafka:commands.weave"
    },
    {
      "mapping": {
        "input": "gate_input"
      },
      "technique": {
        "$ref": "../../techniques/search_memory.technique.json"
      },
      "trigger": "kafka:commands.search"
    }
  ],
  "signature": {
    "inputs": {
      "gate_input": {
        "schema": {
          "$ref": "../../tools/GateInput.schema.json"
        },
        "semantics": "borrow"
      }
    },
    "output": {
      "nature": "atomic",
      "schema": {
        "$ref": "../../tools/GateOutput.schema.json"
      }
    }
  },
  "title": "FatesGate",
  "x-familiar-depends": [
    {
      "$ref": "../../components/TigerDataStore.component.json"
    },
    {
      "$ref": "../../components/ContractEnforcer.component.json"
    }
  ],
  "x-familiar-kind": "system",
  "x-familiar-meta-schema": {
    "$ref": "../../architecture/meta/System.meta.schema.json"
  },
  "x-familiar-queue": {
    "$ref": "../queues/daemon-queue.queue.json"
  },
  "x-familiar-reads": [
    {
      "$ref": "../../entities/Moment.schema.json"
    },
    {
      "$ref": "../../entities/Thread.schema.json"
    },
    {
      "$ref": "../../entities/Course.schema.json"
    }
  ],
  "x-familiar-retries": 3,
  "x-familiar-service": {
    "$ref": "../nodes/familiar-daemon.node.json"
  },
  "x-familiar-timeout": "30s",
  "x-familiar-writes": [
    {
      "$ref": "../../entities/Shuttle.schema.json"
    }
  ]
}