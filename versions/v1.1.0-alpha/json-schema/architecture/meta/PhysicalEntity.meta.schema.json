{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://familiar.dev/schemas/architecture/PhysicalEntity.meta.schema.json",
  "title": "PhysicalEntity",
  "description": "The fundamental physical properties that every entity in the VAE manifold must possess. This meta-schema defines the bridge between your Data Model and Physics Engine.",

  "type": "object",
  "required": [
    "id",
    "tenant_id",
    "created_at",
    "updated_at",
    "physics",
    "t_coord",
    "is_latent"
  ],

  "properties": {
    "id": {
      "$ref": "../../primitives/UUID.schema.json",
      "description": "Universal identifier across all entities"
    },

    "tenant_id": {
      "$ref": "../../primitives/UUID.schema.json",
      "description": "Multi-tenant isolation"
    },

    "created_at": {
      "$ref": "../../primitives/Timestamp.schema.json",
      "description": "Creation timestamp"
    },

    "updated_at": {
      "$ref": "../../primitives/Timestamp.schema.json",
      "description": "Last modification timestamp"
    },

    "physics": {
      "type": "object",
      "description": "The VAE (Variational Autoencoder) coordinates and physical properties",
      "required": ["vae_coordinates", "mass", "charge"],
      "properties": {
        "vae_coordinates": {
          "type": "object",
          "description": "The 3D position in the VAE manifold (x, y, z)",
          "required": ["x", "y", "z"],
          "properties": {
            "x": { "type": "number", "description": "VAE dimension 1" },
            "y": { "type": "number", "description": "VAE dimension 2" },
            "z": { "type": "number", "description": "VAE dimension 3" }
          }
        },

        "mass": {
          "type": "number",
          "minimum": 0,
          "description": "The significance/importance of this entity (0.0 = irrelevant, 1.0 = world-defining)"
        },

        "charge": {
          "type": "number",
          "description": "The affective valence (-1.0 = negative, +1.0 = positive, 0.0 = neutral)"
        },

        "temperature": {
          "type": "number",
          "minimum": 0,
          "description": "The 'heat' or arousal level of this entity"
        },

        "velocity": {
          "type": "object",
          "description": "Rate of change in VAE coordinates",
          "properties": {
            "dx_dt": { "type": "number" },
            "dy_dt": { "type": "number" },
            "dz_dt": { "type": "number" }
          }
        }
      }
    },

    "t_coord": {
      "type": "integer",
      "minimum": 0,
      "description": "The temporal coordinate in the Growing Block Universe. 0 = vacuum/latent space, higher values = deeper in the block."
    },

    "is_latent": {
      "type": "boolean",
      "default": true,
      "description": "True = exists in simulation space, False = committed to immutable memory block"
    },

    "quantum": {
      "type": "object",
      "description": "Quantum wavefunction properties for superposition and interference",
      "properties": {
        "amplitudes": {
          "type": "array",
          "description": "Complex amplitudes as [real, imaginary] pairs for wavefunction representation",
          "items": {
            "type": "array",
            "items": { "type": "number" },
            "minItems": 2,
            "maxItems": 2
          }
        },

        "coherence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "How 'sharp' the wavefunction is (0.0 = cloud/diffuse, 1.0 = particle/exact)"
        },

        "frequency": {
          "type": "number",
          "description": "The dominant frequency of oscillation in the quantum field"
        },

        "phase": {
          "type": "number",
          "description": "Phase offset for wavefunction interference calculations"
        }
      }
    }
  },

  "x-familiar-kind": "meta",
  "x-familiar-description": "Base physical properties for all entities in the VAE manifold",

  "x-familiar-persistence": {
    "profile": "timescaledb",
    "hypertable": true,
    "partition_column": "t_coord",
    "chunk_time_interval": "config://physics.block.chunk_size",
    "compression_policy": {
      "after": "config://physics.block.compression_delay"
    },
    "primary_key": ["id", "t_coord"],
    "indexes": [
      "tenant_id",
      "t_coord",
      "physics.mass",
      "physics.charge"
    ]
  }
}