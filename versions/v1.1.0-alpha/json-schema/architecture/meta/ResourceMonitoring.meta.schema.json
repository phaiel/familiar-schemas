{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://familiar.dev/schemas/architecture/meta/ResourceMonitoring.meta.schema.json",
  "title": "Resource Monitoring Meta-Schema",
  "description": "Schema for defining infrastructure resource monitoring and metrics collection",
  "type": "object",
  "properties": {
    "connection_pool_metrics": {
      "type": "boolean",
      "default": true,
      "description": "Whether to collect connection pool metrics (active, idle, waiting connections)"
    },
    "performance_metrics": {
      "type": "boolean",
      "default": true,
      "description": "Whether to collect performance metrics (latency, throughput, error rates)"
    },
    "error_rate_tracking": {
      "type": "boolean",
      "default": true,
      "description": "Whether to track and alert on error rates"
    },
    "resource_utilization": {
      "type": "object",
      "description": "Resource utilization monitoring configuration",
      "properties": {
        "cpu_usage": { "type": "boolean", "default": true },
        "memory_usage": { "type": "boolean", "default": true },
        "disk_usage": { "type": "boolean", "default": true },
        "network_usage": { "type": "boolean", "default": true },
        "io_operations": { "type": "boolean", "default": true }
      }
    },
    "custom_metrics": {
      "type": "object",
      "description": "Custom resource-specific metrics configuration",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "enabled": { "type": "boolean", "default": true },
          "collection_interval": {
            "type": "string",
            "pattern": "^\\d+(s|m)$",
            "default": "30s"
          },
          "aggregation": {
            "type": "string",
            "enum": ["sum", "avg", "min", "max", "count"],
            "default": "avg"
          },
          "thresholds": {
            "type": "object",
            "properties": {
              "warning": { "type": "number" },
              "critical": { "type": "number" }
            }
          }
        }
      }
    },
    "health_indicators": {
      "type": "array",
      "description": "Health indicators to monitor for this resource",
      "items": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "description": "Indicator name" },
          "type": {
            "type": "string",
            "enum": ["connectivity", "performance", "capacity", "consistency"],
            "description": "Type of health indicator"
          },
          "check_command": { "type": "string", "description": "Command or query to perform health check" },
          "expected_result": { "type": "string", "description": "Expected result from health check" },
          "severity": {
            "type": "string",
            "enum": ["low", "medium", "high", "critical"],
            "default": "medium"
          }
        }
      }
    },
    "alerting_thresholds": {
      "type": "object",
      "description": "Resource-specific alerting thresholds",
      "properties": {
        "connection_pool_exhaustion": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.9,
          "description": "Threshold for connection pool utilization alerts (0.0-1.0)"
        },
        "response_time_degradation": {
          "type": "string",
          "pattern": "^\\d+(ms|s)$",
          "default": "5s",
          "description": "Threshold for response time degradation alerts"
        },
        "error_rate_threshold": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.05,
          "description": "Threshold for error rate alerts (0.0-1.0)"
        },
        "capacity_warning": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.8,
          "description": "Threshold for capacity utilization warnings (0.0-1.0)"
        }
      }
    }
  },
  "additionalProperties": false,
  "x-familiar-kind": "meta",
  "x-familiar-domain": "monitoring"
}
