{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "meta/CodegenMeta.schema.json",
  "title": "CodegenMeta",
  "description": "Meta-schema for Rust codegen extensions. Cross-cutting, applies to all schema types.",
  "x-familiar-kind": "meta",
  "x-familiar-generated": false,
  "additionalProperties": false,
  "properties": {
    "x-familiar-rust-impl-ids": {
      "type": "array",
      "description": "Stable PascalCase identifiers mapping to impl_/{snake_case}.rs modules",
      "items": {
        "type": "string",
        "pattern": "^[A-Z][a-zA-Z0-9]*$"
      }
    },
    "x-familiar-rust-derive-add": {
      "type": "array",
      "description": "Derives to add to the default set",
      "items": {
        "type": "string",
        "pattern": "^[A-Za-z_][A-Za-z0-9_]*$"
      }
    },
    "x-familiar-rust-derive-exclude": {
      "type": "array",
      "description": "Derives to remove from the default set",
      "items": {
        "type": "string",
        "pattern": "^[A-Za-z_][A-Za-z0-9_]*$"
      }
    },
    "x-familiar-rust-derives": {
      "type": "array",
      "description": "Full override of derives (exceptional use only, prefer add/exclude)",
      "items": {
        "type": "string",
        "pattern": "^[A-Za-z_][A-Za-z0-9_]*$"
      }
    },
    "x-familiar-rust-derive-policy": {
      "type": "string",
      "description": "How graph-derived derive suggestions are handled",
      "enum": ["strict", "allow_graph_suggestions"],
      "default": "strict"
    },
    "x-familiar-rust-default": {
      "type": "string",
      "description": "Default trait implementation strategy",
      "enum": ["derived", "custom", "none"],
      "default": "derived"
    },
    "x-familiar-rust-serde": {
      "type": "object",
      "description": "Struct-level serde settings (NOT for unions - use x-familiar-enum-repr)",
      "additionalProperties": false,
      "properties": {
        "rename_all": {
          "type": "string",
          "description": "Field naming convention (camelCase, snake_case, etc.)"
        },
        "deny_unknown_fields": {
          "type": "boolean",
          "description": "Fail on unknown fields during deserialization"
        },
        "default": {
          "type": "boolean",
          "description": "Use Default trait for missing fields"
        },
        "transparent": {
          "type": "boolean",
          "description": "Transparent wrapper (single-field structs)"
        }
      }
    },
    "x-familiar-rust-recursion": {
      "type": "object",
      "description": "SCC/cycle handling override for recursive types",
      "additionalProperties": false,
      "properties": {
        "strategy": {
          "type": "string",
          "description": "How to break the cycle",
          "enum": ["box", "arc", "value_fallback"],
          "default": "box"
        },
        "preferred_edges": {
          "type": "array",
          "description": "Field names where boxing should be applied (if strategy requires)",
          "items": {
            "type": "string"
          }
        }
      }
    }
  }
}




