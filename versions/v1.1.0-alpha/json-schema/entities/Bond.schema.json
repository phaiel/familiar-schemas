{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Core identity component that all entities possess",
  "properties": {
    "amplitude": {
      "allOf": [
        {
          "$ref": "../primitives/NormalizedFloat.schema.json"
        }
      ],
      "description": "**Amplitude (Mass):** The strength of the field excitation. High Amplitude: Core Beliefs, Long-term Memories. Hard to annihilate. Low Amplitude: Fleeting thoughts. Easily absorbed back into the vacuum."
    },
    "bond_strength": {
      "allOf": [
        {
          "$ref": "../primitives/NormalizedFloat.schema.json"
        }
      ],
      "description": "The overall strength or health of the bond. 0.0 = Broken/Weak, 1.0 = Strong/Healthy"
    },
    "created_at": {
      "allOf": [
        {
          "$ref": "../primitives/Timestamp.schema.json"
        }
      ],
      "description": "When this entity was created"
    },
    "damping_coefficient": {
      "description": "The 'inertia' of the bond, representing how quickly it returns to equilibrium. Higher values = slower return to rest (lingering effects). Lower values = quick recovery (resilient).",
      "format": "double",
      "type": "number"
    },
    "energy": {
      "allOf": [
        {
          "$ref": "../primitives/NormalizedFloat.schema.json"
        }
      ],
      "description": "**Energy (Activation):** The current potential/kinetic energy of the excitation."
    },
    "formalism": {
      "allOf": [
        {
          "$ref": "../primitives/NormalizedFloat.schema.json"
        }
      ],
      "description": "**Formalism (Transactionalism / Spring Stiffness):** 1.0 = Rigid/Brittle (High k). Hard to move, snaps if stretched. 0.0 = Fluid/Elastic (Low k). Easy to stretch, adapts to change."
    },
    "head_thread_id": {
      "$ref": "../primitives/UUID.schema.json"
    },
    "id": {
      "allOf": [
        {
          "$ref": "../primitives/UUID.schema.json"
        }
      ],
      "description": "Unique identifier for this entity"
    },
    "intimacy": {
      "allOf": [
        {
          "$ref": "../primitives/NormalizedFloat.schema.json"
        }
      ],
      "description": "**Intimacy (Communal Strength / Rest Length):** 1.0 = Fusion (Rest Length 0). The entities want to occupy the same space. 0.0 = Estrangement (Max Rest Length)."
    },
    "metadata": {
      "additionalProperties": {
        "type": "string"
      },
      "type": "object"
    },
    "position": {
      "description": "The location in the 3D VAE Manifold where the field is excited",
      "items": {
        "$ref": "../primitives/QuantizedCoord.schema.json"
      },
      "maxItems": 3,
      "minItems": 3,
      "type": "array"
    },
    "power_dynamic": {
      "allOf": [
        {
          "$ref": "../primitives/SignedNormalizedFloat.schema.json"
        }
      ],
      "description": "**Power Dynamic (Authority Gradient / Mass Bias):** -1.0 = Target is the Anchor (Infinite Mass relative to Source). 0.0 = Equal Mass (Both move equally). +1.0 = Source is the Anchor."
    },
    "primary_label": {
      "type": [
        "string",
        "null"
      ]
    },
    "spectral_signature": {
      "description": "**Color Filter (Spectral Gating):** If set, this bond only \"lights up\" under specific emotional light. e.g., A \"Work Friend\" bond might only reflect \"Professional\" (Blue) light. Stored as a hex code or vector for the shader.",
      "items": {
        "format": "float",
        "type": "number"
      },
      "maxItems": 3,
      "minItems": 3,
      "type": [
        "array",
        "null"
      ]
    },
    "spring_constant": {
      "description": "The 'stiffness' of the bond, representing its resistance to change. Higher values = more rigid relationship (breaks under stress). Lower values = more flexible relationship (stretches without breaking).",
      "format": "double",
      "type": "number"
    },
    "tail_thread_id": {
      "$ref": "../primitives/UUID.schema.json"
    },
    "temperature": {
      "allOf": [
        {
          "$ref": "../primitives/NormalizedFloat.schema.json"
        }
      ],
      "description": "**Temperature (Volatility):** Internal kinetic energy of the field at this point. High Temp: The field vibrates (High uncertainty/plasticity). Low Temp: The field is frozen (Crystallized/Immutable)."
    },
    "tenant_id": {
      "$ref": "../primitives/TenantId.schema.json"
    },
    "text": {
      "type": "string"
    },
    "transparency": {
      "allOf": [
        {
          "$ref": "../primitives/NormalizedFloat.schema.json"
        }
      ],
      "description": "**Transparency (Refractive Index):** 1.0 = Clear. Looking at the Source reveals the Target (e.g., \"Honest\"). 0.0 = Opaque. The relationship hides the Target (e.g., \"Secretive\")."
    },
    "velocity": {
      "description": "The rate of change of the field amplitude at this location (Cognitive Drift)",
      "items": {
        "$ref": "../primitives/QuantizedCoord.schema.json"
      },
      "maxItems": 3,
      "minItems": 3,
      "type": "array"
    }
  },
  "required": [
    "amplitude",
    "bond_strength",
    "created_at",
    "damping_coefficient",
    "energy",
    "formalism",
    "head_thread_id",
    "id",
    "intimacy",
    "metadata",
    "position",
    "power_dynamic",
    "spring_constant",
    "tail_thread_id",
    "temperature",
    "tenant_id",
    "text",
    "transparency",
    "velocity"
  ],
  "title": "Bond",
  "type": "object",
  "x-familiar-kind": "entity",
  "x-familiar-persistence": {
    "profile": "postgres",
    "table": "bonds",
    "primary_key": "id",
    "indexes": ["source_id", "target_id", "created_at"]
  },
  "x-familiar-service": {
    "$ref": "../nodes/familiar-daemon.node.json"
  }
}