{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "A Course is a persistent session tracking conversation history\n\nThe Course is the \"history bucket\" in the Loom Pattern. It: - Owns the conversation history (append-only) - Tracks session status (idle, active, archived) - Survives across Shuttle processing cycles - Has a 1:N relationship with Shuttles\n\nThe Course does NOT contain: - Transient processing state (that's on Shuttle) - Current weave/input (that's on Shuttle) - Processing metadata like provider/model (that's on Shuttle)",
  "properties": {
    "created_at": {
      "allOf": [
        {
          "$ref": "../primitives/Timestamp.schema.json"
        }
      ],
      "description": "When this course was created"
    },
    "history": {
      "default": [],
      "description": "Message history (append-only, immutable during processing)",
      "items": {
        "$ref": "CourseMessage.schema.json"
      },
      "type": "array"
    },
    "id": {
      "$ref": "../primitives/CourseId.schema.json"
    },
    "metadata": {
      "allOf": [
        {
          "$ref": "CourseMetadata.schema.json"
        }
      ],
      "default": {
        "is_pinned": false,
        "total_history_tokens": 0
      },
      "description": "Session-level metadata"
    },
    "status": {
      "allOf": [
        {
          "$ref": "../types/CourseStatus.schema.json"
        }
      ],
      "description": "Session status (Idle, Active, Archived)"
    },
    "summary": {
      "description": "AI-generated summary",
      "type": [
        "string",
        "null"
      ]
    },
    "tenant_id": {
      "$ref": "../primitives/TenantId.schema.json"
    },
    "title": {
      "description": "Optional title for the course",
      "type": [
        "string",
        "null"
      ]
    },
    "updated_at": {
      "allOf": [
        {
          "$ref": "../primitives/Timestamp.schema.json"
        }
      ],
      "description": "When this course was last updated (message added)"
    }
  },
  "required": [
    "created_at",
    "id",
    "status",
    "tenant_id",
    "updated_at"
  ],
  "title": "Course",
  "type": "object",
  "x-familiar-kind": "entity",
  "x-familiar-persistence": {
    "profile": "postgres",
    "table": "courses",
    "primary_key": "id",
    "indexes": [
      "tenant_id",
      "created_at"
    ]
  },
  "x-familiar-service": {
    "$ref": "../nodes/familiar-daemon.node.json"
  }
}
