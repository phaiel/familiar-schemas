{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "KnownEntity": {
      "description": "Known entity for reference resolution",
      "properties": {
        "aliases": {
          "default": [],
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "entity_type": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        }
      },
      "required": [
        "entity_type",
        "id",
        "name"
      ],
      "type": "object"
    },
    "ModalityInput": {
      "description": "Input container for different modalities",
      "oneOf": [
        {
          "properties": {
            "content": {
              "type": "string"
            },
            "language": {
              "default": null,
              "type": [
                "string",
                "null"
              ]
            },
            "modality": {
              "enum": [
                "text"
              ],
              "type": "string"
            }
          },
          "required": [
            "content",
            "modality"
          ],
          "type": "object"
        },
        {
          "properties": {
            "data": {
              "description": "Base64 encoded audio data",
              "type": "string"
            },
            "duration_seconds": {
              "default": null,
              "description": "Duration in seconds",
              "format": "double",
              "type": [
                "number",
                "null"
              ]
            },
            "format": {
              "description": "Audio format (mp3, wav, etc.)",
              "type": "string"
            },
            "modality": {
              "enum": [
                "audio"
              ],
              "type": "string"
            }
          },
          "required": [
            "data",
            "format",
            "modality"
          ],
          "type": "object"
        },
        {
          "properties": {
            "data": {
              "description": "Base64 encoded image data",
              "type": "string"
            },
            "format": {
              "description": "Image format (png, jpg, etc.)",
              "type": "string"
            },
            "height": {
              "default": null,
              "format": "uint32",
              "minimum": 0.0,
              "type": [
                "integer",
                "null"
              ]
            },
            "modality": {
              "enum": [
                "vision"
              ],
              "type": "string"
            },
            "width": {
              "default": null,
              "description": "Image dimensions",
              "format": "uint32",
              "minimum": 0.0,
              "type": [
                "integer",
                "null"
              ]
            }
          },
          "required": [
            "data",
            "format",
            "modality"
          ],
          "type": "object"
        },
        {
          "properties": {
            "data": {
              "description": "Base64 encoded video data or URL",
              "type": "string"
            },
            "duration_seconds": {
              "default": null,
              "description": "Duration in seconds",
              "format": "double",
              "type": [
                "number",
                "null"
              ]
            },
            "format": {
              "description": "Video format (mp4, webm, etc.)",
              "type": "string"
            },
            "fps": {
              "default": null,
              "description": "Frame rate",
              "format": "double",
              "type": [
                "number",
                "null"
              ]
            },
            "modality": {
              "enum": [
                "video"
              ],
              "type": "string"
            }
          },
          "required": [
            "data",
            "format",
            "modality"
          ],
          "type": "object"
        }
      ]
    },
    "SegmentationConfig": {
      "description": "Configuration for segmentation behavior",
      "properties": {
        "extract_entities": {
          "default": true,
          "description": "Whether to extract entity mentions",
          "type": "boolean"
        },
        "extract_temporal": {
          "default": true,
          "description": "Whether to extract temporal markers",
          "type": "boolean"
        },
        "language": {
          "default": null,
          "description": "Language hint (ISO 639-1)",
          "type": [
            "string",
            "null"
          ]
        },
        "max_segments": {
          "default": 20,
          "description": "Maximum number of segments to produce",
          "format": "uint",
          "minimum": 0.0,
          "type": "integer"
        },
        "min_segment_length": {
          "default": null,
          "description": "Minimum segment length (chars for text, seconds for audio/video)",
          "format": "double",
          "type": [
            "number",
            "null"
          ]
        }
      },
      "type": "object"
    },
    "SegmentationContext": {
      "description": "Context for segmentation",
      "properties": {
        "current_speaker": {
          "default": null,
          "description": "Current speaker (if known)",
          "type": [
            "string",
            "null"
          ]
        },
        "known_entities": {
          "default": [],
          "description": "Known entities for reference resolution",
          "items": {
            "$ref": "KnownEntity.schema.json"
          },
          "type": "array"
        },
        "previous_segments": {
          "default": [],
          "description": "Previous segments in the conversation",
          "items": {
            "$ref": "../primitives/Segment.schema.json"
          },
          "type": "array"
        },
        "tenant_id": {
          "description": "Tenant ID for multi-tenancy",
          "type": "string"
        }
      },
      "required": [
        "tenant_id"
      ],
      "type": "object"
    }
  },
  "description": "Input for segmentation tools",
  "properties": {
    "config": {
      "allOf": [
        {
          "$ref": "SegmentationConfig.schema.json"
        }
      ],
      "default": {
        "extract_entities": true,
        "extract_temporal": true,
        "language": null,
        "max_segments": 20,
        "min_segment_length": null
      },
      "description": "Configuration options"
    },
    "context": {
      "anyOf": [
        {
          "$ref": "SegmentationContext.schema.json"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Context from conversation/session"
    },
    "input": {
      "allOf": [
        {
          "$ref": "ModalityInput.schema.json"
        }
      ],
      "description": "The input to segment"
    }
  },
  "required": [
    "input"
  ],
  "title": "SegmentationInput",
  "type": "object",
  "x-familiar-kind": "tool",
  "x-familiar-queue": {
    "$ref": "../queues/worker-queue.queue.json"
  },
  "x-familiar-role": "input",
  "x-familiar-service": {
    "$ref": "../nodes/familiar-worker.node.json"
  }
}
