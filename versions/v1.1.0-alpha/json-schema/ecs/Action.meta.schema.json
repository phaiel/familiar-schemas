{
  "$id": "https://familiar.dev/schemas/ecs/Action.meta.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Action Definition (v2)",
  "description": "Defines an atomic capability with explicit IO port contracts.",
  "type": "object",
  "required": ["id", "x-familiar-kind", "signature"],
  "properties": {
    "id": { "type": "string" },
    "title": { "type": "string" },
    "description": { "type": "string" },

    "x-familiar-kind": {
      "const": "action",
      "description": "Discriminator for the graph loader"
    },

    "signature": {
      "type": "object",
      "required": ["inputs", "output"],
      "properties": {
        "inputs": {
          "type": "object",
          "description": "Map of argument names to their type definitions and memory semantics",
          "additionalProperties": {
            "type": "object",
            "required": ["schema"],
            "properties": {
              "schema": {
                "description": "Reference to the data type schema",
                "type": "object",
                "properties": { "$ref": { "type": "string" } },
                "required": ["$ref"]
              },
              "semantics": {
                "description": "Memory management for the Arena",
                "$ref": "../meta/PortSemantics.schema.json",
                "default": "borrow"
              },
              "optional": {
                "type": "boolean",
                "default": false
              }
            }
          }
        },
        "output": {
          "type": "object",
          "required": ["schema"],
          "properties": {
            "schema": {
              "description": "Reference to the return type schema",
              "type": "object",
              "properties": { "$ref": { "type": "string" } },
              "required": ["$ref"]
            },
            "nature": {
              "description": "Execution behavior",
              "type": "string",
              "enum": ["atomic", "stream", "future"],
              "default": "atomic"
            }
          }
        }
      }
    }
  }
}
